#!/usr/bin/env node

import fs from 'node:fs'
import path from 'node:path'

const bundlePath = path.join(import.meta.dirname, '..', 'cli-build', 'flamegraph.js')
const outputPath = path.join(import.meta.dirname, '..', 'src', 'generated', 'bundle.ts')

// Ensure directory exists
fs.mkdirSync(path.dirname(outputPath), { recursive: true })

// Read the bundle
const bundle = fs.readFileSync(bundlePath, 'utf8')

// Generate TypeScript file with escaped content
const content = `// This file is auto-generated by scripts/generate-bundle.js - do not edit
export const FLAMEGRAPH_BUNDLE = ${JSON.stringify(bundle)}
`

fs.writeFileSync(outputPath, content)
console.log('Generated src/generated/bundle.ts')
